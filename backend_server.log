INFO:     Will watch for changes in these directories: ['/Users/user/dev/work/spotlistchecker/backend']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [44037] using StatReload
INFO:     Started server process [44062]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:54700 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:54705 - "POST /generate-insights HTTP/1.1" 200 OK
INFO:     127.0.0.1:54865 - "POST /generate-insights HTTP/1.1" 200 OK
/Users/user/dev/work/spotlistchecker/backend/main.py:72: UserWarning: DataFrame columns are not unique, some columns will be omitted.
  return df.map(_convert).to_dict(orient="records")
Analyzing file: spotlist_company_ebay.csv, window: 60
INFO:     127.0.0.1:54954 - "POST /analyze HTTP/1.1" 200 OK
INFO:     127.0.0.1:54956 - "POST /generate-insights HTTP/1.1" 200 OK
/Users/user/dev/work/spotlistchecker/backend/main.py:72: UserWarning: DataFrame columns are not unique, some columns will be omitted.
  return df.map(_convert).to_dict(orient="records")
Analyzing file: spotlist_company_ebay.csv, window: 120
INFO:     127.0.0.1:64060 - "POST /analyze HTTP/1.1" 200 OK
/Users/user/dev/work/spotlistchecker/backend/main.py:72: UserWarning: DataFrame columns are not unique, some columns will be omitted.
  return df.map(_convert).to_dict(orient="records")
Analyzing file: spotlist_company_ebay.csv, window: 120
INFO:     127.0.0.1:64251 - "POST /analyze HTTP/1.1" 200 OK
/Users/user/dev/work/spotlistchecker/backend/main.py:72: UserWarning: DataFrame columns are not unique, some columns will be omitted.
  return df.map(_convert).to_dict(orient="records")
Analyzing file: spotlist_company_ebay.csv, window: 120
INFO:     127.0.0.1:64771 - "POST /analyze HTTP/1.1" 200 OK
/Users/user/dev/work/spotlistchecker/backend/main.py:72: UserWarning: DataFrame columns are not unique, some columns will be omitted.
  return df.map(_convert).to_dict(orient="records")
Analyzing file: spotlist_company_ebay.csv, window: 60
INFO:     127.0.0.1:64787 - "POST /analyze HTTP/1.1" 200 OK
INFO:     127.0.0.1:49956 - "OPTIONS /generate-insights HTTP/1.1" 200 OK
INFO:     127.0.0.1:49956 - "POST /generate-insights HTTP/1.1" 200 OK
/Users/user/dev/work/spotlistchecker/backend/main.py:72: UserWarning: DataFrame columns are not unique, some columns will be omitted.
  return df.map(_convert).to_dict(orient="records")
Analyzing file: spotlist_company_ebay.csv, window: 65
INFO:     127.0.0.1:50054 - "POST /analyze HTTP/1.1" 200 OK
Traceback (most recent call last):
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Airing date'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/dev/work/spotlistchecker/backend/main.py", line 169, in analyze_spotlist
    df_annotated = checker.annotate_spotlist(df)
  File "/Users/user/dev/work/spotlistchecker/backend/spotlist_checkerv2.py", line 131, in annotate_spotlist
    df["timestamp"] = df.apply(
                      ~~~~~~~~^
        lambda row: build_datetime_for_comparison(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        axis=1,
        ^^^^^^^
    )
    ^
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/frame.py", line 10401, in apply
    return op.apply().__finalize__(self, method="apply")
           ~~~~~~~~^^
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/apply.py", line 916, in apply
    return self.apply_standard()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
                 ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/user/dev/work/spotlistchecker/backend/spotlist_checkerv2.py", line 133, in <lambda>
    row[cfg.column_map["date"]],
    ~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/series.py", line 1133, in __getitem__
    return self._get_value(key)
           ~~~~~~~~~~~~~~~^^^^^
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/series.py", line 1249, in _get_value
    loc = self.index.get_loc(label)
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Airing date'
Analyzing file: spotlist_check - daten (1).csv, window: 65
Error analyzing spotlist: 'Airing date'
INFO:     127.0.0.1:50189 - "POST /analyze HTTP/1.1" 500 Internal Server Error
/Users/user/dev/work/spotlistchecker/backend/main.py:72: UserWarning: DataFrame columns are not unique, some columns will be omitted.
  return df.map(_convert).to_dict(orient="records")
Analyzing file: spotlist_company_ebay.csv, window: 75
INFO:     127.0.0.1:50272 - "POST /analyze HTTP/1.1" 200 OK
WARNING:  StatReload detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [44062]
INFO:     Started server process [33053]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [33053]
INFO:     Started server process [33436]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [33436]
INFO:     Started server process [33963]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [33963]
INFO:     Started server process [34186]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [34186]
INFO:     Started server process [34872]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
Analyzing file: spotlist_annotated_2025-12-05.xlsx, window: 75
Detected format: english
Column mapping: {'program': 'Channel', 'date': 'Airing date', 'time': 'Airing time', 'cost': 'Spend', 'sendung_medium': 'Claim', 'sendung_long': 'EPG name'}
INFO:     127.0.0.1:50413 - "POST /analyze HTTP/1.1" 200 OK
Traceback (most recent call last):
  File "/Users/user/dev/work/spotlistchecker/backend/main.py", line 304, in analyze_spotlist
    metrics = checker.compute_metrics(df_annotated)
  File "/Users/user/dev/work/spotlistchecker/backend/spotlist_checkerv2.py", line 217, in compute_metrics
    cost_col = cfg.column_map["cost"]
               ~~~~~~~~~~~~~~^^^^^^^^
KeyError: 'cost'
Analyzing file: spotlist_check - daten (1).csv, window: 60
Detected format: german
Column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
Error analyzing spotlist: 'cost'
INFO:     127.0.0.1:50435 - "POST /analyze HTTP/1.1" 500 Internal Server Error
Traceback (most recent call last):
  File "/Users/user/dev/work/spotlistchecker/backend/main.py", line 304, in analyze_spotlist
    metrics = checker.compute_metrics(df_annotated)
  File "/Users/user/dev/work/spotlistchecker/backend/spotlist_checkerv2.py", line 217, in compute_metrics
    cost_col = cfg.column_map["cost"]
               ~~~~~~~~~~~~~~^^^^^^^^
KeyError: 'cost'
Analyzing file: spotlist_check - daten (1).csv, window: 60
Detected format: german
Column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
Error analyzing spotlist: 'cost'
INFO:     127.0.0.1:50435 - "POST /analyze HTTP/1.1" 500 Internal Server Error
Traceback (most recent call last):
  File "/Users/user/dev/work/spotlistchecker/backend/main.py", line 304, in analyze_spotlist
    metrics = checker.compute_metrics(df_annotated)
  File "/Users/user/dev/work/spotlistchecker/backend/spotlist_checkerv2.py", line 217, in compute_metrics
    cost_col = cfg.column_map["cost"]
               ~~~~~~~~~~~~~~^^^^^^^^
KeyError: 'cost'
Analyzing file: spotlist_check - daten (1).csv, window: 60
Detected format: german
Column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
Error analyzing spotlist: 'cost'
INFO:     127.0.0.1:50435 - "POST /analyze HTTP/1.1" 500 Internal Server Error
WARNING:  StatReload detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [34872]
INFO:     Started server process [36350]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'spotlist_checkerv2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [36350]
INFO:     Started server process [36542]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [36542]
INFO:     Started server process [36836]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'spotlist_checkerv2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [36836]
INFO:     Started server process [37056]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [37056]
INFO:     Started server process [37346]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'spotlist_checkerv2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [37346]
INFO:     Started server process [37543]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
Traceback (most recent call last):
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Airing date'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/dev/work/spotlistchecker/backend/main.py", line 430, in analyze_spotlist
    df_w = checker_w.annotate_spotlist(df) # Run on original df
  File "/Users/user/dev/work/spotlistchecker/backend/spotlist_checkerv2.py", line 149, in annotate_spotlist
    df["timestamp"] = df.apply(
                      ~~~~~~~~^
        lambda row: build_datetime_for_comparison(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        axis=1,
        ^^^^^^^
    )
    ^
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/frame.py", line 10401, in apply
    return op.apply().__finalize__(self, method="apply")
           ~~~~~~~~^^
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/apply.py", line 916, in apply
    return self.apply_standard()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
                 ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/user/dev/work/spotlistchecker/backend/spotlist_checkerv2.py", line 151, in <lambda>
    row[cfg.column_map["date"]],
    ~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/series.py", line 1133, in __getitem__
    return self._get_value(key)
           ~~~~~~~~~~~~~~~^^^^^
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/series.py", line 1249, in _get_value
    loc = self.index.get_loc(label)
  File "/Users/user/dev/work/spotlistchecker/backend/venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Airing date'
Analyzing file: spotlist_check - daten (1).csv, window: 60
German format detected. Final column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
Available columns in dataframe: ['Kunde', 'Produkt', 'Kamp', 'Verm.', 'Medium', 'Datum', 'Uhr', 'ZSI', 'Spl', 'Motiv', 'Kosten ctc.', 'Titel vor', 'Titel nach', 'GRP', 'SKZ Ag3', 'Unnamed: 15', 'Unnamed: 16']
Detected format: german
Column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
Error processing response data: 'Airing date'
INFO:     127.0.0.1:50572 - "POST /analyze HTTP/1.1" 500 Internal Server Error
/Users/user/dev/work/spotlistchecker/backend/main.py:72: UserWarning: DataFrame columns are not unique, some columns will be omitted.
  return df.map(_convert).to_dict(orient="records")
Analyzing file: spotlist_company_ebay.csv, window: 60
Detected format: english
Column mapping: {'program': 'Channel', 'date': 'Airing date', 'time': 'Airing time', 'cost': 'Spend', 'sendung_medium': 'Claim', 'sendung_long': 'EPG name'}
INFO:     127.0.0.1:50589 - "POST /analyze HTTP/1.1" 200 OK
WARNING:  StatReload detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [37543]
INFO:     Started server process [40524]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [40524]
INFO:     Started server process [40653]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
Analyzing file: spotlist_check - daten (1).csv, window: 60
German format detected. Final column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
Available columns in dataframe: ['Kunde', 'Produkt', 'Kamp', 'Verm.', 'Medium', 'Datum', 'Uhr', 'ZSI', 'Spl', 'Motiv', 'Kosten ctc.', 'Titel vor', 'Titel nach', 'GRP', 'SKZ Ag3', 'Unnamed: 15', 'Unnamed: 16']
Detected format: german
Column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
INFO:     127.0.0.1:50873 - "POST /analyze HTTP/1.1" 200 OK
Analyzing file: spotlist_check - daten (1).csv, window: 60
German format detected. Final column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
Available columns in dataframe: ['Kunde', 'Produkt', 'Kamp', 'Verm.', 'Medium', 'Datum', 'Uhr', 'ZSI', 'Spl', 'Motiv', 'Kosten ctc.', 'Titel vor', 'Titel nach', 'GRP', 'SKZ Ag3', 'Unnamed: 15', 'Unnamed: 16']
Detected format: german
Column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
INFO:     127.0.0.1:51169 - "POST /analyze HTTP/1.1" 200 OK
Analyzing file: spotlist_check - daten (1).csv, window: 120
German format detected. Final column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
Available columns in dataframe: ['Kunde', 'Produkt', 'Kamp', 'Verm.', 'Medium', 'Datum', 'Uhr', 'ZSI', 'Spl', 'Motiv', 'Kosten ctc.', 'Titel vor', 'Titel nach', 'GRP', 'SKZ Ag3', 'Unnamed: 15', 'Unnamed: 16']
Detected format: german
Column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
INFO:     127.0.0.1:51259 - "POST /analyze HTTP/1.1" 200 OK
WARNING:  StatReload detected changes in 'spotlist_checkerv2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [40653]
INFO:     Started server process [51525]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
Analyzing file: spotlist_check - daten (1).csv, window: 120
German format detected. Final column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
Available columns in dataframe: ['Kunde', 'Produkt', 'Kamp', 'Verm.', 'Medium', 'Datum', 'Uhr', 'ZSI', 'Spl', 'Motiv', 'Kosten ctc.', 'Titel vor', 'Titel nach', 'GRP', 'SKZ Ag3', 'Unnamed: 15', 'Unnamed: 16']
Detected format: german
Column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
INFO:     127.0.0.1:51337 - "POST /analyze HTTP/1.1" 200 OK
/Users/user/dev/work/spotlistchecker/backend/main.py:72: UserWarning: DataFrame columns are not unique, some columns will be omitted.
  return df.map(_convert).to_dict(orient="records")
Analyzing file: spotlist_company_ebay.csv, window: 120
Detected format: english
Column mapping: {'program': 'Channel', 'date': 'Airing date', 'time': 'Airing time', 'cost': 'Spend', 'sendung_medium': 'Claim', 'sendung_long': 'EPG name'}
INFO:     127.0.0.1:51383 - "POST /analyze HTTP/1.1" 200 OK
Analyzing file: spotlist_check - daten (1).csv, window: 120
German format detected. Final column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
Available columns in dataframe: ['Kunde', 'Produkt', 'Kamp', 'Verm.', 'Medium', 'Datum', 'Uhr', 'ZSI', 'Spl', 'Motiv', 'Kosten ctc.', 'Titel vor', 'Titel nach', 'GRP', 'SKZ Ag3', 'Unnamed: 15', 'Unnamed: 16']
Detected format: german
Column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
INFO:     127.0.0.1:51419 - "POST /analyze HTTP/1.1" 200 OK
WARNING:  StatReload detected changes in 'spotlist_checkerv2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [51525]
INFO:     Started server process [54714]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'spotlist_checkerv2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [54714]
INFO:     Started server process [54867]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'spotlist_checkerv2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [54867]
INFO:     Started server process [55019]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'spotlist_checkerv2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [55019]
INFO:     Started server process [55179]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
Analyzing file: spotlist_check - daten (1).csv, window: 120
German format detected. Final column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
Available columns in dataframe: ['Kunde', 'Produkt', 'Kamp', 'Verm.', 'Medium', 'Datum', 'Uhr', 'ZSI', 'Spl', 'Motiv', 'Kosten ctc.', 'Titel vor', 'Titel nach', 'GRP', 'SKZ Ag3', 'Unnamed: 15', 'Unnamed: 16']
Detected format: german
Column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
INFO:     127.0.0.1:51614 - "POST /analyze HTTP/1.1" 200 OK
WARNING:  StatReload detected changes in 'spotlist_checkerv2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [55179]
INFO:     Started server process [57040]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
Analyzing file: spotlist_check - daten (1).csv, window: 120
German format detected. Final column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
Available columns in dataframe: ['Kunde', 'Produkt', 'Kamp', 'Verm.', 'Medium', 'Datum', 'Uhr', 'ZSI', 'Spl', 'Motiv', 'Kosten ctc.', 'Titel vor', 'Titel nach', 'GRP', 'SKZ Ag3', 'Unnamed: 15', 'Unnamed: 16']
Detected format: german
Column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
INFO:     127.0.0.1:51660 - "POST /analyze HTTP/1.1" 200 OK
INFO:     127.0.0.1:51801 - "OPTIONS /generate-insights HTTP/1.1" 200 OK
INFO:     127.0.0.1:51801 - "POST /generate-insights HTTP/1.1" 200 OK
/Users/user/dev/work/spotlistchecker/backend/main.py:72: UserWarning: DataFrame columns are not unique, some columns will be omitted.
  return df.map(_convert).to_dict(orient="records")
Analyzing file: spotlist_company_ebay.csv, window: 120
Detected format: english
Column mapping: {'program': 'Channel', 'date': 'Airing date', 'time': 'Airing time', 'cost': 'Spend', 'sendung_medium': 'Claim', 'sendung_long': 'EPG name'}
INFO:     127.0.0.1:51840 - "POST /analyze HTTP/1.1" 200 OK
Analyzing file: spotlist_check - daten (1).csv, window: 120
German format detected. Final column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
Available columns in dataframe: ['Kunde', 'Produkt', 'Kamp', 'Verm.', 'Medium', 'Datum', 'Uhr', 'ZSI', 'Spl', 'Motiv', 'Kosten ctc.', 'Titel vor', 'Titel nach', 'GRP', 'SKZ Ag3', 'Unnamed: 15', 'Unnamed: 16']
Detected format: german
Column mapping: {'program': 'Medium', 'date': 'Datum', 'time': 'Uhr', 'cost': 'Kosten ctc.', 'sendung_medium': 'Motiv', 'sendung_long': 'Titel vor'}
INFO:     127.0.0.1:52234 - "POST /analyze HTTP/1.1" 200 OK
/Users/user/dev/work/spotlistchecker/backend/main.py:72: UserWarning: DataFrame columns are not unique, some columns will be omitted.
  return df.map(_convert).to_dict(orient="records")
Analyzing file: spotlist_company_ebay.csv, window: 120
Detected format: english
Column mapping: {'program': 'Channel', 'date': 'Airing date', 'time': 'Airing time', 'cost': 'Spend', 'sendung_medium': 'Claim', 'sendung_long': 'EPG name'}
INFO:     127.0.0.1:52280 - "POST /analyze HTTP/1.1" 200 OK
INFO:     127.0.0.1:52420 - "OPTIONS /generate-insights HTTP/1.1" 200 OK
INFO:     127.0.0.1:52420 - "POST /generate-insights HTTP/1.1" 200 OK
